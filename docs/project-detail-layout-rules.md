# Project Detail Layout Rules

This document records how `src/pages/ProjectDetail.vue` renders project detail sections and how to configure layouts in JSON data (for example `src/data/projects/snow-weather.json`).

## 1) Section Layout Types

Each item in `sections` supports different layout modes:

- `layout: "split"`: left gallery + right text.
- `layout: "grid"` (or omitted): normal section flow (text then gallery).
- `layout: "stack"`: single-column gallery in normal (non-split) mode.

`split` is handled in `ProjectDetail.vue` by:
- `v-if="section.layout === 'split'"` at `src/pages/ProjectDetail.vue:81`
- `v-else` normal layout at `src/pages/ProjectDetail.vue:131`

## 2) Split Gallery (JSON Control)

For split sections, gallery style is generated by `getSplitGalleryStyle(section)`:
- `src/pages/ProjectDetail.vue:86`
- function at `src/pages/ProjectDetail.vue:318`

Supported JSON fields on a split section:

- `splitGalleryGapDesktop`: gallery item gap on desktop (`>= 768px`).
- `splitGalleryGapMobile`: gallery item gap on mobile (`< 768px`).
- `splitGalleryColumnsDesktop`: gallery columns on desktop.
- `splitGalleryColumnsMobile`: gallery columns on mobile.

Column fallback rule:
- Desktop default: `1` if `splitGalleryColumnsDesktop` is not set.
- Mobile default: `1` if `splitGalleryColumnsMobile` is not set.

## 3) Image Fields

Per-image options:

- `src`: image path.
- `alt`: caption source. If omitted, no caption is rendered.
- `thumbFit`: currently supports `contain`.
- `thumbRatio`: supports:
  - `"auto"`: auto ratio mode.
  - ratio string like `"4 / 3"`, `"16 / 9"`, `"1 / 1"`.
- `thumbSize`: supports `"narrow"` (smaller item width).

## 4) Caption and Alt Behavior

Current behavior in `ProjectDetail.vue`:

- `<figcaption v-if="image.alt">` at:
  - `src/pages/ProjectDetail.vue:111`
  - `src/pages/ProjectDetail.vue:168`
  - `src/pages/ProjectDetail.vue:206`
- `<img :alt="image.alt || ''">` (empty alt if missing, no fallback title).

Result:
- If `alt` exists: caption appears.
- If `alt` is missing: no caption block is rendered.

## 5) `thumbFit` and `thumbRatio` Interaction

Base thumb behavior is defined in `src/project-detail-style.css`:

- Default image fit: `object-fit: cover` (cropped fill).
- `.project-detail-thumb--contain img` => `object-fit: contain`.
- `.project-detail-thumb--auto` and `.project-detail-thumb--auto img` => auto ratio + contain behavior.

Important:
- If `thumbRatio` is `"auto"`, class `project-detail-thumb--auto` is applied, which also leads to full-image contain behavior.
- If you want cropped display with custom ratio, use ratio like `"4 / 3"` and do not use `"auto"`.

## 6) Common JSON Patterns

Split section with 2x2 desktop / 1-column mobile:

```json
{
  "id": "example-split-gallery",
  "layout": "split",
  "splitGalleryGapDesktop": "8px",
  "splitGalleryGapMobile": "0px",
  "splitGalleryColumnsDesktop": 2,
  "splitGalleryColumnsMobile": 1,
  "text": "<p><strong>Title:</strong><br>...</p>",
  "images": [
    { "src": "/media/projects/x/a.png", "thumbRatio": "4 / 3" },
    { "src": "/media/projects/x/b.png", "thumbRatio": "4 / 3" },
    { "src": "/media/projects/x/c.png", "thumbRatio": "4 / 3" },
    { "src": "/media/projects/x/d.png", "thumbRatio": "4 / 3" }
  ]
}
```

Full-image display (no crop):

```json
{ "src": "/media/projects/x/a.png", "thumbFit": "contain", "thumbRatio": "auto" }
```

Cropped display with fixed ratio:

```json
{ "src": "/media/projects/x/a.png", "thumbRatio": "16 / 9" }
```

## 7) Current Implementation Notes

- Split gallery style is controlled in JS, not via section-specific CSS classes.
- Per-section spacing and columns should be driven from JSON first.
- If behavior seems unexpected, verify both:
  - JSON field values.
  - whether `thumbRatio` is set to `"auto"` (this changes fit behavior).
